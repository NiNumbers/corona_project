# ---------- Dataframe vorbereiten -------------
corona_kum <- data.frame(datum = seq(as.Date("2020/02/26"), Sys.Date(), "days"))
dauer <- length(corona_kum$datum)
corona_kum$day <- rep(c("Mittwoch", "Donnerstag", "Freitag", "Samstag", "Sonntag", "Montag", "Dienstag"), length.out = dauer)


# --------- Entwicklung aufzeigen, Daten bis ca. 19. MÃ¤rz: Tagi, Rest BAG  ----------------------
CHkum <- c(1, 8, 12, 21, 27, 42, 58, 90, 116, 210, 264, 337, 389, 509, 645, 858, 1125, 1359, 1650, 2200, 2650, 3028, 
           3888, 4840, 6113, 7014, 8060, 8836, 9765, 10714, 12161, 13213, 14336, 15475,  16176, 17139, 18267, 19303, 
           20278, 21100, 21652, 22242, 22789, 23574, 24308, 24900, 25300, 25580, 25834, 26336, 26732, 27078, 27404, 
           27740, 27944, 28063, 28268, 28496, 28677, 28894, 29061, 29164, 29264, 29407, 29586, 29705, 29817, 29905, 
           29981, 30009, 30060, 30126, 30207, 30251, 30305, 30344, 30380, 30413, 30463, 30514, 30572, 30587, 30597, 
           30618, 30658, 30694, 30707, 30725, 30736, 30746, 30761, 30776, 30796, 30828, 30845, 30862, 30871, 30874, 
           30893, 30913, 30936, 30956, 30965, 30972, 30988, 31011, 31044, 31063, 31094, 31117, 31131, 31146, 31183, 
           31200, 31217, 31243, 31292, 31310, 31332, 31376, 31428, 31486, 31555, 31617) 
 
verstorbenCHkum <- c(19, 21, 33, 43, 56, 60, 66, 86, 103, 161, 197, 235, 257, 295, 373, 378, 432, 484, 540, 559, 584, 641, 
                     705, 756, 805, 831, 858, 885, 900, 973, 1017, 1059, 1111, 1135, 1142, 1187, 1217, 1268, 1309, 1329, 1337, 
                     1353, 1380, 1408, 1423, 1435, 1467, 1473, 1477, 1483, 1505, 1518, 1526, 1532, 1538, 1543, 1561, 1564, 
                     1589, 1595, 1602, 1603, 1603, 1614, 1630, 1638, 1638, 1641, 1641, 1642, 1648, 1649, 1655, 1657,  1657,
                     1657, 1657, 1657, 1660, 1660, 1660, 1661, 1661, 1661, 1663, 1675,1675, 1677, 1677, 1677, 1677, 1678,
                     1678, 1678, 1680, 1680, 1680, 1680, 1680, 1682, 1682, 1682, 1682, 1682)

# Match mit Schweizer Daten, korrelierend auf 1000 Faelle. DE: 1 Tag verschoben, IT 11 d verschoben, US 2 d verschoben
DEkum <- c(0, 0, 0, 0, 0, 0, 0, 0, 57, 150, 188, 240, 349, 534, 684, 847, 1150, 1565, 2369, 3062, 4838, 6012, 9352, 12327, 
           15320,	19848, 22213, 24904, 30150, 33593, 39502, 47278, 53340, 58247, 62435, 67051, 72383, 77981, 84794, 91159,
           96108, 100132, 103375, 107663, 113296, 118235, 122171, 125834, 127854, 130072, 132210, 134753, 138135, 141397, 
           143724, 145743, 147065, 148453, 150729, 153129, 155418, 156513, 157770, 158841, 159912, 161539, 163009, 164077, 
           164967, 165664, 166199, 167007, 168162, 169430, 170588, 171324, 171879, 172576, 173171, 174098, 174478, 175699, 
           176244, 176551, 177289, 177842, 178545, 179150, 179730, 179986, 180338, 180802, 181293, 181918, 182559, 183025,
           183302, 183500, 183771, 184097, 184427, round((184427+(185416-184427)/2),0), 185416, 185696, 185869, 186233,
           186522, 186525, 186883, 187263, 187267, 187682, 188213, 188449, 189445, 190203, 190670, 191225, 191657, 192127,
           192786, 193257, 193790, 194403, 194693)
ITkum <- c(0, 0, 0, 0, 0, 0, 0, 0, 11, 76, 124, 229, 374, 528, 650, 888, 1100, 1700, 2000, 2502, 3089, 3858, 4636,  5883, 
           7375, 9172, 10149, 12462, 15061, 17660, 21157, 24747, 31506, 35713, 41035, 47021, 53578, 59138, 63927, 69176, 
           74386, 80598, 86498, 92472, 97689, 101739, 105792,  110574, 115242, 119827, 124632, 128948, 132547, 135586, 
           139422, 143626, 147577, 152271, 156363, 159516, 162488, 165155, 168941, 172434, 175925, 178972, 181228, 183957,
           187327, 189973, 192994, 195351, 197675, 199590, 201505, 203591, 205463, 207428, 209328, 210717, 211938, 213013,
           214457, 215858, 217185, 218268, 219070, 219814, 221216, 222104, 223096, 223885, 224760, 225435, 225886, 226699,
           227364, 228006, 228658, 229327, 229858, 230158, 230555, 231139, 231732,232248, 232664, 232997, 233197, 233515,
           233836, round((233836+ (234531 -233836)/2), 0), 234531, 234801, 234998, 235278, 235561, 235763, 236142, 236305,
           236651, 236989, 237290, 237500, 237828, 237950, 238011, 238275, 238499, 238720, 238833, 239410, 239706, 239961,
           240136)
USkum <- c(15, 16, 51, 57, 58, 60, 68, 74, 98, 118, 149, 217, 262, 402, 518, 583, 959, 1300, 1700, 2200, 2700, 3500, 4600, 
           6400, 7800, 13700, 19100, 25500, 33300, 43800, 54935, 69197, 85996, 104837, 124686, 143055, 164610, 189633, 
           216772, 245573, 278458, 312245, 337646, 368449, 399929, 432438, 466299, 501615, 530830, 557590, 582594, 609685, 
           639664, 671425, 706779, 735287, 759786, 787960, 825306, 842624, 869172, 907096, 939249, 965933, 989258, 1012583,
           1040488, 1070032, 1104161, 1133069, 1158341, 1180634, 1204475, 1228609, 1256972, 1283929, 1309541, 1329799, 1347936,
           1369964, 1390764, 1417889, 1443397, 1467884, 1487447, 1508957, 1528661, 1551853, 1577758, 1601434, 1622670, 
           1643499, 1662768, 1681418, 1699933, 1721926, 1747087, 1770384, 1790191, 1811277, 1831821, 1851520, 
           round((1851520+ (1897838-1851520)/2), 0), 1897838, 1920061, 1942363, 1961185, 1979893, 2000464, 2023347, 2048986,
           2074526, 2094069, 2114026, 2137731, 2164071, 2191200, 2222576, 2255119, 2280969, 2312302, 2347102, 2381369,
           2422312, 2467837, 2510323) 
# Dataframe mit auf Schweizer Fallzahlen normierte Werte generieren
corona_kum$CHkum <- CHkum
corona_kum$DEkum <- DEkum[0:dauer]
corona_kum$ITkum <- ITkum[0:dauer] 
corona_kum$USkum <- USkum[0:dauer] 

# ------------- Taegliche Fallzahlen, wiederum auf Schweiz normiert --------
corona_taegl <- corona_kum[ , c("datum", "day")]
corona_taegl$CHtaeglich <- rep(1, dauer)
corona_taegl$DEtaeglich <- rep(0, dauer)
corona_taegl$ITtaeglich <- rep(0, dauer)
corona_taegl$UStaeglich <- rep(0, dauer)

for (i in 2:dauer) {
  corona_taegl$CHtaeglich[i] = corona_kum$CHkum[i] - corona_kum$CHkum[i-1]
  corona_taegl$DEtaeglich[i] = corona_kum$DEkum[i] - corona_kum$DEkum[i-1]
  corona_taegl$ITtaeglich[i] = corona_kum$ITkum[i] - corona_kum$ITkum[i-1]
  corona_taegl$UStaeglich[i] = corona_kum$USkum[i] - corona_kum$USkum[i-1]
}
CHtaegl <- corona_taegl$CHtaeglich
DEtaegl <- DEkum
for (i in 2:length(DEkum)) {
  DEtaegl[i] = DEkum[i] - DEkum[i-1]
}
ITtaegl <- ITkum
for (i in 2:length(ITkum)) {
  ITtaegl[i] = ITkum[i] - ITkum[i-1]
}
UStaegl <- USkum
for (i in 2:length(USkum)) {
  UStaegl[i] = USkum[i] - USkum[i-1]
}
rm(i)
# -------------- Landesdataframes machen mit allen Daten
corona_CH <- corona_kum[ , c("datum", "CHkum")]
corona_CH$CHtaegl <- corona_taegl$CHtaeglich

corona_DE <- data.frame(datum = seq(as.Date("2020/03/04"), Sys.Date(), "days"))
corona_DE$DEkum <- DEkum[9:length(DEkum)]
corona_DE$DEtaegl <- DEtaegl[9:length(DEkum)]

corona_IT <- data.frame(datum = seq(as.Date("2020/02/23"), Sys.Date(), "days"))
corona_IT$ITkum <- ITkum[9:length(ITkum)]
corona_IT$ITtaegl <- ITtaegl[9:length(ITkum)]

corona_US <- data.frame(datum = seq(as.Date("2020/02/24"), Sys.Date(), "days"))
corona_US$USkum <- USkum
corona_US$UStaegl <- UStaegl

# ---------------- save Data ---------
# for shiny app
save(corona_DE, corona_IT, corona_US, corona_CH, file = "corona_shiny.RData")
# all data
save.image(file = "corona_all_data.RData")